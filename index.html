<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek Chat | OpenRouter API</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.1/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-robot logo"></i> DeepSeek Chat</h1>
            <div class="subtitle">Powered by OpenRouter API</div>
            <div class="api-status">
                <span class="status-dot" id="status-dot"></span>
                <span id="status-text">Checking API</span>
            </div>
        </header>
        
        <div class="main-content">
            <div class="panels-container">
                <div class="config-panel">
                    <div class="panel-header" id="config-panel-header">
                        <h3><i class="fas fa-cog"></i> Configuration</h3>
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="panel-content expanded" id="config-panel-content">
                        <p class="info-text" id="config-status">Checking configuration...</p>
                        <div id="cloudflare-status" class="cf-status">
                            <i class="fas fa-cloud"></i>
                            <span>Checking Cloudflare environment variable...</span>
                        </div>
                        <div class="api-config-form">
                            <div class="form-group">
                                <label for="api-key-input">OpenRouter API Key</label>
                                <input type="password" id="api-key-input" placeholder="Enter your API key">
                            </div>
                            <div class="form-group">
                                <label for="model-input">Model Name</label>
                                <input type="text" id="model-input" value="deepseek/deepseek-chat-v3.1:free" placeholder="Enter model name">
                            </div>
                            <button id="save-config">Save Configuration</button>
                        </div>
                    </div>
                </div>

                <div class="info-panel">
                    <div class="panel-header" id="info-panel-header">
                        <h3><i class="fas fa-info-circle"></i> Information</h3>
                        <i class="fas fa-chevron-down toggle-icon"></i>
                    </div>
                    <div class="panel-content expanded" id="info-panel-content">
                        <div class="info-text">
                            <p>This chat interface uses the OpenRouter API to connect to AI models. It will first try to use the API key from Cloudflare Pages environment variables, but you can also manually provide one.</p>
                            <p>Get your API key from <a href="https://openrouter.ai/keys" target="_blank">https://openrouter.ai/keys</a></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chat-container" id="chat-container">
                <div class="message ai-message">
                    <div class="message-content">
                        <i class="fas fa-robot"></i> Hello! I'm DeepSeek, an AI assistant powered by OpenRouter. How can I help you today?
                    </div>
                    <span class="message-info">Model: <span id="current-model">deepseek/deepseek-chat-v3.1:free</span></span>
                </div>
            </div>
        </div>

        <div class="typing-indicator" id="typing-indicator">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <span id="typing-model">DeepSeek is typing...</span>
        </div>

        <div class="input-container">
            <input type="text" id="user-input" placeholder="Type your message here..." autocomplete="off" disabled>
            <button id="send-button" disabled>
                <i class="fas fa-paper-plane"></i> Send
            </button>
        </div>

        <div class="controls">
            <button id="toggle-panels">
                <i class="fas fa-bars"></i> Toggle Panels
            </button>
            <div class="control-group">
                <button id="save-pdf">
                    <i class="fas fa-file-pdf"></i> Save as PDF
                </button>
                <button id="clear-chat">
                    <i class="fas fa-trash"></i> Clear Chat
                </button>
            </div>
        </div>
    </div>

    <div id="pdf-loading" class="pdf-loading">
        <div class="spinner"></div>
        <p>Generating PDF, please wait...</p>
    </div>

    <script src="script.js"></script>
</body>
</html>
