<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OpenRouter — Free Models</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#6ee7b7;
      --accent-2:#60a5fa; --glass: rgba(255,255,255,0.03);
      --radius:14px; --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #071025 0%, #071a2a 50%, #081425 100%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:40px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* Option B layout: keep centered card, constrain height and make results scroll internally */
    .wrap{
      width:min(980px, 96%);
      height: calc(100vh - 80px); /* keep some margin around */
      max-height: calc(100vh - 80px);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius);
      box-shadow: 0 10px 30px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
      overflow:hidden;
      display:grid;
      grid-template-columns: 1fr 380px;
      gap:0;
    }

    header{
      padding:20px 24px;
      display:flex;
      gap:12px;
      align-items:center;
      border-bottom: 1px solid rgba(255,255,255,0.03);
      grid-column: 1 / -1;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      flex:0 0 auto;
    }

    .logo {
      width:48px; height:48px; border-radius:10px;
      background: linear-gradient(135deg,var(--accent), var(--accent-2));
      display:flex; align-items:center; justify-content:center;
      font-weight:700; color:#04202a; font-family:var(--mono);
      box-shadow: 0 6px 18px rgba(96,165,250,0.12);
      flex:0 0 48px;
    }

    h1{font-size:18px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    main{
      padding:18px 20px;
      display:flex;
      flex-direction:column;
      gap:12px;
      overflow:hidden; /* contain internal scrolling */
    }

    .controls{
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
      flex:0 0 auto;
    }

    .input{
      display:flex;
      gap:8px;
      align-items:center;
      background:var(--card);
      padding:8px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.02);
      box-shadow: 0 4px 12px rgba(2,6,23,0.5);
    }

    input[type="password"]{
      background:transparent;
      border:0; outline:0; color:inherit;
      width:320px; font-size:14px;
    }

    button.primary{
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      border:0; color:#04202a; padding:8px 12px; border-radius:10px;
      font-weight:600; cursor:pointer; box-shadow: 0 8px 24px rgba(6,95,70,0.12);
    }
    button.ghost{
      background:transparent; border:1px solid rgba(255,255,255,0.04);
      color:var(--muted); padding:8px 12px; border-radius:10px; cursor:pointer;
    }

    .status{
      color:var(--muted); font-size:13px;
    }

    /* RESULTS: scroll internally while header/sidebar remain fixed */
    .results{
      flex:1 1 auto;
      background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));
      border-radius:12px; padding:14px; overflow:auto; border:1px solid rgba(255,255,255,0.02);
      font-family: var(--mono); font-size:13px; line-height:1.5;
    }

    .empty{
      color:var(--muted); display:flex; align-items:center; gap:12px;
      height:100%; justify-content:center; text-align:center; padding:24px;
      font-size:14px;
    }

    aside{
      padding:16px;
      border-left:1px solid rgba(255,255,255,0.02);
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      display:flex;
      flex-direction:column;
      gap:12px;
      flex:0 0 380px;
    }

    .card{
      background:var(--glass); border-radius:12px; padding:12px; margin-bottom:6px;
      border:1px solid rgba(255,255,255,0.02);
    }

    .card h3{margin:0 0 8px 0; font-size:13px}
    .hint{color:var(--muted); font-size:13px}

    .chip{display:inline-block;background:rgba(255,255,255,0.03); padding:6px 8px; border-radius:999px; font-size:12px; color:var(--muted)}
    pre.ids{
      background:rgba(2,6,23,0.6); padding:12px; border-radius:8px; color:var(--accent);
      overflow:auto; margin:0; white-space:pre-wrap; word-break:break-word;
    }

    .error{color:#ffb4b4; background:rgba(255,80,80,0.06); padding:10px; border-radius:8px}

    footer{
      grid-column:1/-1;
      padding:10px 20px;
      border-top:1px solid rgba(255,255,255,0.02);
      display:flex; justify-content:space-between; align-items:center; gap:12px;
      font-size:13px;color:var(--muted);
      flex:0 0 auto;
    }

    @media (max-width:880px){
      .wrap{grid-template-columns:1fr; height: calc(100vh - 40px); max-height: calc(100vh - 40px);}
      aside{border-left:0;border-top:1px solid rgba(255,255,255,0.02); flex:0 0 auto}
      input[type="password"]{width:160px}
      .wrap{padding-bottom:8px}
    }
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="OpenRouter free models">
    <header>
      <div class="logo">OR</div>
      <div>
        <h1>OpenRouter — Free models</h1>
        <p class="lead">Find models where prompt and completion pricing are both 0</p>
      </div>
      <div style="margin-left:auto; display:flex; gap:10px; align-items:center">
        <span class="chip">endpoint: /api/v1/models</span>
      </div>
    </header>

    <main>
      <div class="controls" aria-hidden="false">
        <div class="input" role="group" aria-label="API key">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.9;flex:0 0 18px">
            <path d="M12 1v6" stroke="rgba(255,255,255,0.6)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="12" cy="14" r="7" stroke="rgba(255,255,255,0.12)" stroke-width="1.4"/>
          </svg>
          <input id="apiKey" type="password" placeholder="Optional API key (sk-...)" />
        </div>

        <button id="runBtn" class="primary" title="Fetch models">Fetch free models</button>
        <button id="clearBtn" class="ghost" title="Clear results">Clear</button>
        <div class="status" id="status">Idle</div>
      </div>

      <div class="results" id="results" aria-live="polite">
        <div class="empty">Press "Fetch free models" to query OpenRouter. Results will appear here.</div>
      </div>
    </main>

    <aside>
      <div class="card">
        <h3>What this does</h3>
        <div class="hint">Fetches /api/v1/models and filters models where <code>pricing.prompt == "0"</code> and <code>pricing.completion == "0"</code>. No jq required.</div>
      </div>

      <div class="card">
        <h3>Tips</h3>
        <ul style="margin:0;padding-left:18px;color:var(--muted);font-size:13px">
          <li>Provide an API key if the endpoint requires authorization.</li>
          <li>Results show model IDs only; click a result to copy it.</li>
        </ul>
      </div>

      <div class="card" style="display:flex;gap:8px;align-items:center;flex-direction:column">
        <button id="copyAll" class="primary" style="width:100%;">Copy all IDs</button>
        <button id="download" class="ghost" style="width:100%;">Download .txt</button>
      </div>
    </aside>

    <footer>
      <div>Made for quick discovery</div>
      <div style="color:var(--muted)">Results filtered client-side • OpenRouter</div>
    </footer>
  </div>

  <script>
    const runBtn = document.getElementById('runBtn');
    const clearBtn = document.getElementById('clearBtn');
    const resultsDiv = document.getElementById('results');
    const status = document.getElementById('status');
    const apiKeyInput = document.getElementById('apiKey');
    const copyAllBtn = document.getElementById('copyAll');
    const downloadBtn = document.getElementById('download');

    async function fetchModels() {
      const key = apiKeyInput.value.trim();
      status.textContent = 'Loading…';
      resultsDiv.innerHTML = '<div class="empty">Loading models…</div>';
      try {
        const res = await fetch('https://openrouter.ai/api/v1/models', {
          headers: key ? { 'Authorization': 'Bearer ' + key } : {}
        });
        if (!res.ok) {
          const txt = await res.text();
          status.textContent = 'HTTP ' + res.status;
          resultsDiv.innerHTML = '<div class="error">HTTP ' + res.status + ': ' + escapeHtml(txt) + '</div>';
          return [];
        }
        const data = await res.json();
        if (!Array.isArray(data.data)) {
          status.textContent = 'Unexpected response';
          resultsDiv.innerHTML = '<div class="error">Unexpected response format</div><pre class="ids">' + escapeHtml(JSON.stringify(data, null, 2)) + '</pre>';
          return [];
        }

        // filter where pricing.prompt == "0" and pricing.completion == "0"
        const ids = data.data
          .filter(m => m.pricing && String(m.pricing.prompt) === "0" && String(m.pricing.completion) === "0")
          .map(m => m.id || '(no id)');

        status.textContent = ids.length + ' free model' + (ids.length === 1 ? '' : 's') + ' found';
        renderIds(ids);
        return ids;
      } catch (err) {
        status.textContent = 'Error';
        resultsDiv.innerHTML = '<div class="error">Error: ' + escapeHtml(String(err)) + '</div>';
        return [];
      }
    }

    function renderIds(ids){
      if (!ids || ids.length === 0) {
        resultsDiv.innerHTML = '<div class="empty">No free models found.</div>';
        return;
      }
      const pre = document.createElement('pre');
      pre.className = 'ids';
      pre.textContent = ids.join("\n");

      // clickable list below the pre
      const listWrap = document.createElement('div');
      listWrap.style.marginTop = '12px';
      ids.forEach(id => {
        const btn = document.createElement('button');
        btn.className = 'chip';
        btn.textContent = id;
        btn.style.cursor = 'pointer';
        btn.style.margin = '6px 6px 0 0';
        btn.addEventListener('click', () => {
          navigator.clipboard?.writeText(id).then(()=> {
            btn.textContent = 'Copied ✓';
            setTimeout(()=> btn.textContent = id, 900);
          }).catch(()=>{});
        });
        listWrap.appendChild(btn);
      });

      resultsDiv.innerHTML = '';
      resultsDiv.appendChild(pre);
      resultsDiv.appendChild(listWrap);
    }

    function escapeHtml(s) {
      return String(s)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    runBtn.addEventListener('click', () => { fetchModels(); });
    clearBtn.addEventListener('click', () => {
      resultsDiv.innerHTML = '<div class="empty">Cleared.</div>';
      status.textContent = 'Idle';
      apiKeyInput.value = '';
    });

    copyAllBtn.addEventListener('click', async () => {
      const txt = document.querySelector('.ids')?.textContent || '';
      if (!txt) return;
      try {
        await navigator.clipboard.writeText(txt);
        copyAllBtn.textContent = 'Copied ✓';
        setTimeout(()=> copyAllBtn.textContent = 'Copy all IDs', 900);
      } catch {}
    });

    downloadBtn.addEventListener('click', () => {
      const txt = document.querySelector('.ids')?.textContent || '';
      if (!txt) return;
      const blob = new Blob([txt], {type:'text/plain;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'openrouter-free-model-ids.txt';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
